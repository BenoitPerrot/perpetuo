logging = true

auth {
  jwt.secret = "local-jwt-secret"
  host = "http://auth"
  authorize.url = ${auth.host}"/auth/oauth2/authorize?realm=test&client_id=perpetuo&response_type=token"
  tokeninfo.url = ${auth.host}"/auth/oauth2/tokeninfo?realm=test"
}

db {
  ephemeral = true

  name = "Deployment_DB"
  driver {
    name = "org.h2.Driver"
    profile = "h2"
  }
  schema = "dbo"
  username = "sa"

  poolMinSize = 1
  poolMaxSize = 5
  idleTimeout = 20000
  connectionTimeout = 30000
}

selfUrl = "http://somewhere"

targetDispatcher {
  type = "class"
  class = "com.criteo.perpetuo.engine.TargetDispatcherForTesting"
}

permissions {
  type = "fineGrained"
  fineGrained {
    perGeneralAction {
      addProduct {
        userNames = ["bob.the.producer"]
      }
    }
    perProduct = [
      {
        regex = ".*"
        perAction {
          requestOperation {
            groupNames = ["Users"]
          }
          applyOperation {
            userNames = ["r.eleaser"]
          }
        }
      }
    ]
  }
}
