<link rel="import" href="../../bower_components/polymer/polymer.html"/>

<script>
'use strict';

this.Perpetuo = this.Perpetuo || {};
this.Perpetuo.Util = this.Perpetuo.Util || (function () {
  return {
    isString(x) {
      return typeof x === 'string' || x instanceof String;
    },

    computeTargetExpressionLabel(e) {
      // TODO: remove once data in the DB gets rewritten <<
      if (e === '*' || (Array.isArray(e) && e.length === 1 && e[0] === '*'))
        return 'All configured targets';
      // >>
      if (Perpetuo.Util.isString(e))
        return e;
      if (e.union) {
        const united = e.union.map(Perpetuo.Util.computeTargetExpressionLabel);
        return united.length === 1 ? united[0] : `(${united.join(' ∪ ')})`;
      }
      if (e.intersection) {
        const intersected = e.intersection.map(Perpetuo.Util.computeTargetExpressionLabel);
        return intersected.length === 1 ? intersected[0] : `(${intersected.join(' ∩ ')})`;
      }
      if (e.icontains) {
        return `${e.icontains}~`;
      }
      if (e.tag) {
        return e.tag;
      }
      if (Array.isArray(e)) { // TODO: remove once fully migrated to target expressions
        return e;
      }
      return 'All configured targets';
    }

  };
}());
</script>
