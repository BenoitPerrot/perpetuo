<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/paper-card/paper-card.html">

<link rel="import" href="../perpetuo-app/perpetuo-app-toolbar.html">
<link rel="import" href="../perpetuo-client/perpetuo-client.html">
<link rel="import" href="../perpetuo-product/perpetuo-product-table.html">

<script>(function () {
class PerpetuoProductsPage extends Polymer.Element {

  static get template() {
    return Polymer.html`
<style>
paper-card {
  flex: 1;
  margin: 1em;
  display: flex;
}
perpetuo-product-table {
  flex: 1;
}
</style>
<perpetuo-app-toolbar page-title="Perpetuo / Products"></perpetuo-app-toolbar>

<div style="display: flex; width: 100%;">
  <paper-card>
    <perpetuo-product-table id="productTable"></perpetuo-product-table>
  </paper-card>
</div>
`;
  }

  static get is() { return 'perpetuo-products-page'; }

  constructor() {
    super();

    this.client = new Perpetuo.Client();
  }

  connectedCallback() {
    super.connectedCallback();

    this.client.fetchProducts().then(products => {
      this.$.productTable.data = products;
    });
    this.client.getAllowedActions().then(actions => {
      this.$.productTable.canUpdateProduct = actions.includes("updateProduct") ? "enabled" : "disabled";
    });
  }
}

customElements.define(PerpetuoProductsPage.is, PerpetuoProductsPage);
}());</script>
