<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../perpetuo-deployment-request/perpetuo-target-status-table.html">

<script>
function arrayifyTargetStatus(targetStatusMap) {
  return Object.keys(targetStatusMap).map(targetAtom => {
    const targetAtomStatus = targetStatusMap[targetAtom];
    return { targetAtom: targetAtom, code: targetAtomStatus.code, detail: targetAtomStatus.detail };
  });
}
</script>

<dom-module id="perpetuo-deployment-operation-condensed">
  <template>
    <style>
    :host {
      padding: 1em;
      display: flex;
      flex-direction: column;
    }

    p {
      margin-top: 0;
      font-size: 20px;
      color: hsl(0,0%,13%);
      text-transform: capitalize;
    }
    </style>
    <p>Operation: [[operationKind]]</p>
    <perpetuo-target-status-table data="[[targetStatus]]"></perpetuo-target-status-table>
  </template>
  <script>
  Polymer({
    is: 'perpetuo-deployment-operation-condensed',

    properties: {
      data: { type: Object, observer: 'onDataChanged' },

      targetStatus: { type: Array, value: () => [] },
      operationKind: { type: String },
    },

    onDataChanged(data) {
      this.targetStatus = arrayifyTargetStatus(data.targetStatus);
      this.operationKind = data.kind;
    },
  });
  </script>
</dom-module>
